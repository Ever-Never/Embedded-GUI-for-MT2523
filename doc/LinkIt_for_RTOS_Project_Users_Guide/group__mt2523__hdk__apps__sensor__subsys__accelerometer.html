<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Example projects and demos: sensor_subsys_accelerometer</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="MediaTek.PNG"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Example projects and demos
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="modules.html"><span>Project&#160;user's&#160;guide</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__mt2523__hdk__apps__sensor__subsys__accelerometer.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">sensor_subsys_accelerometer<div class="ingroups"><a class="el" href="group__mt2523__hdk.html">mt2523_hdk</a> &raquo; <a class="el" href="group__mt2523__hdk__apps.html">apps</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<dl class="section user"><dt>Overview</dt><dd><ul>
<li>This project is a reference application on getting the accelerometer sensor data using the sensor subsystem API.</li>
<li>Enable the sensor<ul>
<li>Call the function #hal_pinmux_set_function() or use the EPT tool to set the GPIO pinmux to configure the I2C digital interface and external interrupt pinmux settings. Please refer to bsp_sensor_peripheral_init() in [sdk_root]/driver/board/mt25x3_hdk/mems_init/mems_init.c.</li>
<li>Sensor subsystem task (sensor_mgr_task() in [sdk_root]/middleware/MTK/sensor_subsys/src/sensor_manager.c) gets accelerometer sensor data through an interrupt.</li>
</ul>
</li>
<li>Results<ul>
<li>The received accelerometer data is displayed in the log.</li>
</ul>
</li>
</ul>
</dd></dl>
<dl class="section user"><dt>Hardware and software environment</dt><dd><ul>
<li>Supported HDK<ul>
<li>MediaTek LinkIt 2523 HDK.</li>
<li>MediaTek MT2511 biosensor daughterboard (model number: MTK0067). Alternatively, a Bosch BMA255 shuttle board can be used as a substitute. For more information on BMA255 shuttle board, please visit <a href="https://www.bosch-sensortec.com/bst/home/home_overview">https://www.bosch-sensortec.com/bst/home/home_overview</a>.<ul>
<li>The connection of the digital interface between BMA255 shuttle board and LinkIt 2523 HDK is shown below.<ul>
<li>Find the <b>Sensor</b> connector on LinkIt 2523 HDK.</li>
<li>Connection configuration <table class="doxtable">
<tr>
<th>LinkIt 2523 HDK PIN Name </th><th>Sensor connector(Con6301) PIN # </th><th>GPIOx </th><th>BMA255 shuttle board PIN #  </th></tr>
<tr>
<td>VIO28 </td><td>3 </td><td>- </td><td>1, 2, 9 </td></tr>
<tr>
<td>SDA0 </td><td>7 </td><td>GPIO37 </td><td>5 </td></tr>
<tr>
<td>SCL0 </td><td>9 </td><td>GPIO36 </td><td>6 </td></tr>
<tr>
<td>U304_EINT_CONN </td><td>17 </td><td>GPIO5 </td><td>20 </td></tr>
<tr>
<td>GND </td><td>23, 24 </td><td>- </td><td>3, 4 </td></tr>
</table>
- Please note, the pull-up resistors are needed for the I2C interface to provide the sufficient driving power to the I2C clock and data lines. On LinkIt 2523 HDK, the two pull-up resistors R1003 and R1002 are already installed for the I2C0 interface. When using a different I2C interface, please make sure the pull-up resistors (normally 4.7 kohm) are installed for that particular I2C interface.</li>
</ul>
</li>
<li>The BMI160 sensor component integrated with triaxial accelerometer and gyroscope is on the MTK0067 daughterboard. To use BMI160, a 0 ohm resistor is to be mounted on R6403 (default no connection), which is near BMI160 (U6302) on the MTK0067 daughterboard. The connection configuration <table class="doxtable">
<tr>
<th>LinkIt 2523 HDK PIN Name </th><th>Sensor connector(Con6301) PIN # </th><th>GPIOx  </th></tr>
<tr>
<td>VIO28 </td><td>3 </td><td>- </td></tr>
<tr>
<td>MA_SPI3_B_MISO </td><td>8 </td><td>GPIO28 </td></tr>
<tr>
<td>MA_SPI3_B_MOSI </td><td>10 </td><td>GPIO27 </td></tr>
<tr>
<td>MA_SPI3_B_SCK </td><td>12 </td><td>GPIO26 </td></tr>
<tr>
<td>MA_SPI3_B_CS1 </td><td>13 </td><td>GPIO48 </td></tr>
<tr>
<td>U302_EINT_CONN </td><td>19 </td><td>GPIO6 </td></tr>
<tr>
<td>GND </td><td>23, 24 </td><td>- </td></tr>
</table>
</li>
</ul>
</li>
</ul>
</li>
<li>Environment configuration<ul>
<li>The output logs are communicated through a micro USB cable to the PC from MK20 USB connector on the HDK.</li>
<li>Install the mbed serial driver according to the instructions at <a href="https://developer.mbed.org/handbook/Windows-serial-configuration">https://developer.mbed.org/handbook/Windows-serial-configuration</a>. For more information, please refer to section "Installing the LinkIt 2523
      HDK drivers on Microsoft Windows" on the "LinkIt 2523 HDK User Guide" in [sdk_root]/doc folder.</li>
<li>Use a type-A to micro-B USB cable to connect type-A USB of the PC and MK20 micro-B USB connector on the LinkIt 2523 HDK. For more information about the connector cable, please refer to <a href="https://en.wikipedia.org/wiki/USB#Mini_and_micro_connectors">https://en.wikipedia.org/wiki/USB#Mini_and_micro_connectors</a>.</li>
<li>Launch a terminal emulator program, such as Tera terminal on your PC for data logging through UART. For the installation details, please refer to section "Installing Tera terminal on Microsoft Windows" on the "LinkIt for RTOS Get Started Guide" in [sdk_root]/doc folder.</li>
<li>COM port settings. baudrate: 115200, data bits: 8, stop bit: 1, parity: none and flow control: off.</li>
</ul>
</li>
<li>Customization Option<ul>
<li><b>MTK_SENSOR_ACCELEROMETER_USE_BMA255:</b> Selects and enables the driver for BMA255 component. Please note that MTK_SENSOR_ACCELEROMETER_USE_BMA255 and MTK_SENSOR_ACCELEROMETER_GYROSCOPE_USE_BMI160 should be exclusively defined.</li>
<li><b>MTK_SENSOR_ACCELEROMETER_GYROSCOPE_USE_BMI160:</b> Selects and enables the driver for BMI160 component. Please note that MTK_SENSOR_ACCELEROMETER_GYROSCOPE_USE_BMI160 and MTK_SENSOR_ACCELEROMETER_USE_BMA255 should be exclusively defined.</li>
</ul>
</li>
</ul>
</dd></dl>
<dl class="section user"><dt>Directory contents</dt><dd><ul>
<li>Source and header files<ul>
<li><b>src/main.c</b>: Main program.</li>
<li><b>src/system_mt2523.c</b>: The configuration file of the Cortex-M4 with floating point core registers and system clock.</li>
<li><b>src/sys_init.c</b>: This file initializes the basic hardware environment for the system, including system clock, UART port for logging, pinmux, cache and other necessary hardware.</li>
<li><b>src/ept_eint_var.c</b>: The EINT configuration file generated by Easy Pinmux Tool(EPT). Please do not edit the file.</li>
<li><b>src/ept_gpio_var.c</b>: The GPIO configuration file generated by Easy Pinmux Tool(EPT). Please do not edit the file.</li>
<li><b>inc/FreeRTOSConfig.h</b>: FreeRTOS feature configuration file.</li>
<li><b>inc/task_def.h</b>: Define the task stack size, queue length, project name, and priority for the application to create tasks.</li>
<li><b>inc/hal_feature_config.h</b>: MT2523x feature configuration file.</li>
<li><b>inc/memory_map.h</b>: MT2523x memory layout symbol file.</li>
<li><b>inc/ept_eint_drv.h</b>: The EINT configuration file generated by Easy Pinmux Tool(EPT). Please do not edit the file.</li>
<li><b>inc/ept_gpio_drv.h</b>: The GPIO configuration file generated by Easy Pinmux Tool(EPT). Please do not edit the file.</li>
<li><b>inc/ept_keypad_drv.h</b>: The KEYPAD configuration file generated by Easy Pinmux Tool(EPT). Please do not edit the file.</li>
<li><b>inc/cust_battery_meter.h</b>: The customization file to configure the battery level parameters.</li>
<li><b>inc/cust_battery_meter_table.h</b>: The customization file to configure the battery meter parameters.</li>
<li><b>inc/cust_battery_temperature_table.h</b>: The customization file to configure the battery temperature parameters.</li>
<li><b>inc/cust_charging.h</b>: The customization file to configure the charging parameters.</li>
<li><b>inc/sys_init.h</b>: The header file of sys_init.c.</li>
<li><b>GCC/startup_mt2523.s</b>: MT2523x startup file for GCC.</li>
<li><b>GCC/syscalls.c</b>: The minimal implementation of the system calls.</li>
<li><b>MDK-ARM/startup_mt2523.s</b>: MT2523x startup file for Keil IDE.</li>
<li><b>EWARM/startup_mt2523.s</b>: MT2523x startup file for IAR IDE.</li>
<li><b>&lt;sdk_root&gt;/driver/board/component/mems</b>: The motion sensor driver.</li>
<li><b>&lt;sdk_root&gt;/middleware/MTK/sensor_subsys</b>: The sensor manager implementation to control drivers and report data to application.</li>
</ul>
</li>
<li>Project configuration files using GCC<ul>
<li><b>GCC/feature.mk</b>: Feature configuration.</li>
<li><b>GCC/Makefile</b>: Makefile.</li>
<li><b>GCC/flash.ld</b>: Linker script.</li>
</ul>
</li>
<li>Project configuration files using Keil IDE<ul>
<li><b>MDK-ARM/sensor_subsys_accelerometer.uvprojx</b>: uVision5 Project File. Contains the project structure in XML format.</li>
<li><b>MDK-ARM/sensor_subsys_accelerometer.uvoptx</b>: uVision5 project options. Contains the settings for the debugger, trace configuration, breakpoints, currently opened files, etc.</li>
<li><b>MDK-ARM/flash.sct</b>: Linker script.</li>
</ul>
</li>
<li>Project configuration files using IAR IDE<ul>
<li><b>EWARM/sensor_subsys_accelerometer.ewd</b>: IAR project options. Contains the settings for the debugger.</li>
<li><b>EWARM/sensor_subsys_accelerometer.ewp</b>: IAR project file. Contains the project structure in XML format</li>
<li><b>EWARM/sensor_subsys_accelerometer.eww</b>: IAR workspace file. Contains project information.</li>
<li><b>EWARM/flash.icf</b>: Linker script.</li>
</ul>
</li>
</ul>
</dd></dl>
<dl class="section user"><dt>Run the example</dt><dd><ul>
<li>Build the example project with the command "./build.sh mt2523_hdk
    sensor_subsys_accelerometer" from the SDK root folder and download the binary file to LinkIt 2523 HDK.<ul>
<li>This example project enables BMA255 by default. To change the configuration for enabling BMI160 using<ul>
<li>GCC: modify GCC/feature.mk. Mark MTK_SENSOR_ACCELEROMETER_USE = BMA255 and unmark MTK_SENSOR_ACCELEROMETER_USE = BMI160.</li>
<li>Keil IDE: remove the definitions "MTK_SENSOR_ACCELEROMETER_USE" and "MTK_SENSOR_ACCELEROMETER_USE_BMA255". Add the definitions "MTK_SENSOR_ACCELEROMETER_GYROSCOPE_USE" and "MTK_SENSOR_ACCELEROMETER_GYROSCOPE_USE_BMI160".</li>
<li>IAR IDE: remove the definitions "MTK_SENSOR_ACCELEROMETER_USE" and "MTK_SENSOR_ACCELEROMETER_USE_BMA255". Add the definitions "MTK_SENSOR_ACCELEROMETER_GYROSCOPE_USE" and "MTK_SENSOR_ACCELEROMETER_GYROSCOPE_USE_BMI160".</li>
</ul>
</li>
</ul>
</li>
<li>Connect the HDK to the PC with a micro USB cable.</li>
<li>Run the example. Move MediaTek LinkIt 2523 HDK to trigger accelerometer data change. The log displays the update of the accelerometer data. </li>
</ul>
</dd></dl>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Nov 15 2017 19:29:27 for Example projects and demos by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
